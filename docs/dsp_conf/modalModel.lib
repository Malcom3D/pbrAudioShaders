import("stdfaust.lib");

modalModel(exPos,t60Scale) = _ <: par(mode,nModes,pm.modeFilter(modeFreqs(mode),modesT60s(mode),modesGains(int(exPos),mode))) :> /(nModes)
with{
nModes = 6;
nExPos = 8;
modeFreqsUnscaled(n) = ba.take(n+1,(245.016,245.016,245.022,300.083,330.257,536.209));
modeFreqs(mode) = modeFreqsUnscaled(mode);
modesGains(p,n) = waveform{1,0.99999,0.816491,0.816482,0.99997,0.816484,1,0.999993,0.816496,0.81648,0.999981,0.816489,0.612354,0.61236,1,0.999977,0.612366,0.999982,0.612356,0.612362,1,0.999979,0.612367,0.999983,0.612357,0.612362,1,0.99998,0.612368,0.999984,0.612356,0.612361,1,0.999978,0.612366,0.999983,0.999986,0.999979,0.816338,0.816486,1,0.816456,0.999997,0.999987,0.816341,0.816496,1,0.816459},int(p*nModes+n) : rdtable;
modesT60s(n) = t60Scale * ba.take(n+1,(17.1177,17.1177,17.1177,16.9985,16.9238,16.2541));
};
